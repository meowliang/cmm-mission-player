<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"> -->
    <title>SF Japantown Walking Tour</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <script src="https://aframe.io/releases/1.7.1/aframe.min.js"></script>
</head>
<body>
    <!-- Permission Overlay -->
    <div id="permissionOverlay" class="overlay">
        
        <div class="overlay-content">

            <div class="icon-container">
                <i class="icon fas fa-vr-cardboard"></i>
              </div>

            <h2>Immersive 360° Experience</h2>
      
            <!-- <div class="device-tilt-animation">
              <div class="device-screen"></div>
            </div> -->

            <p>This experience uses your device's motion sensors to create an immersive 360° environment.</p>

            <div class="feature-list">
                <div class="feature-item">
                  <i class="fas fa-music"></i>
                  <span>High-quality audio</span>
                </div>
                <div class="feature-item">
                  <i class="fas fa-vr-cardboard"></i>
                  <span>360° visuals</span>
                </div>
                <div class="feature-item">
                  <i class="fas fa-mobile-alt"></i>
                  <span>Motion controls</span>
                </div>
              </div>

            <div class="permission-steps">
                <p><strong>When prompted:</strong></p>
                <ul>
                  <li>Tap "Allow" to enable motion and orientation access</li>
                  <li>For the best experience, use headphones and move around</li>
                </ul>
              </div>
              <div class="overlay-btns">
            <button id="enableMotionBtn" class="overlay-btn"><strong>Start Experience</strong></button>
            <button id="skipMotionBtn"><p>Exit</p></button>
                </div>
            </div>

    </div>

    <!-- Main Content -->
    <div id="content">
        <!-- Unified Player Container -->
        <div id="playerContainer" class="player-container">
            
            <div class="player-content">
                <!-- Content Area - Switches between audio and XR -->
                <div id="contentArea" class="content-area">
                    <!-- Audio Content -->
                    <div id="audioContent" class="content-section">
                        <div class="album-art">
                            <img id="albumArt" src="https://cmm-cloud-2.s3.us-west-1.amazonaws.com/WALKING+TOURS/2025-03-15-JAPANTOWN/2025-03-15-JAPANTOWN-ART/2025-03-15-JAPANTOWN-CH1-ART.jpg" alt="Album Art">
                        </div>
                        <div class="track-info">
                            <h2 id="trackTitle">Chapter 1: La Placita Raid</h2>
                            <p id="trackArtist">Ni de Aquí, Ni de Allá</p>
                        </div>

                    </div>
                    
                    <!-- XR Content -->
                    <div id="xrContent" class="content-section" style="display: none;">
                        <iframe id="videoFrame" class="video-frame" allowfullscreen></iframe>
                    </div>
                </div>

                                

                <!-- Unified Controls -->
                <div class="player-controls">
                    <button id="menuBtn" class="control-btn"><i class="fas fa-bars"></i></button>
                    <button id="prevBtn" class="control-btn"><i class="fas fa-backward"></i></button>
                    <button id="playPauseBtn" class="control-btn">
                        <span class="play-icon"><i class="fas fa-play"></i></span>
                    </button>
                    <button id="nextBtn" class="control-btn"><i class="fas fa-forward"></i></button>
                                            <!-- Mode Switch -->
                                            <div class="mode-switch">
                                                <button id="viewXRBtn" class="control-btn"><p>View 360°</p></button>
                                                <button id="exitXRBtn" class="control-btn" style="display: none;"><p>Exit 360°</p></button>
                                            </div>

                    
                    <div class="progress-container">
                        <span id="currentTime">0:00</span>
                        <div class="progress-bar">
                            <div id="progress" class="progress"></div>
                        </div>
                        <span id="duration">1:15</span>
                    </div>
                    <div class="volume-control">
                        <button id="muteBtn" class="control-btn"><i class="fas fa-volume-mute"></i></button>
                        <input type="range" id="volumeSlider" min="0" max="1" step="0.1" value="1">
                        <button id="speedBtn" class="control-btn">1x</button>
                    </div>
                </div>


            </div>
        </div>

        <!-- Playlist -->
        <div id="playlistContainer" class="playlist-container">
            <div class="playlist-header">
                <h2>Chapters</h2>
                <button id="playlistClose" class="close-btn">×</button>
            </div>
            <div id="playlistTracks" class="playlist-tracks"></div>
        </div>
    </div>

    <!-- Audio Element -->
    <audio id="audioElement" crossorigin="anonymous" preload="auto" playsinline>
        <source src="https://cmm-cloud-2.s3.us-west-1.amazonaws.com/WALKING+TOURS/2025-03-15-JAPANTOWN/2025-03-15-JAPANTOWN-MP3-AUDIO/2025-03-15-JAPANTOWN-CH-1.mp3" type="audio/mpeg">
    </audio>

    <script type="module" src="app.js"></script>
</body>
</html>